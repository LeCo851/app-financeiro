<div class="chat-container" [class.open]="isOpen" [class.expanded]="isExpanded">
  <div class="chat-header">
    <span class="header-title" (click)="toggleChat()">Assistente Financeiro</span>
    <div class="header-actions">
      <button class="action-btn" (click)="toggleExpand($event)" *ngIf="isOpen" title="Expandir/Reduzir">
        <i class="pi" [ngClass]="isExpanded ? 'pi-window-minimize' : 'pi-window-maximize'"></i>
      </button>
      <button class="action-btn toggle-btn" (click)="toggleChat()">
        <i class="pi" [ngClass]="isOpen ? 'pi-chevron-down' : 'pi-chevron-up'"></i>
      </button>
    </div>
  </div>

  <div class="chat-body" *ngIf="isOpen">
    <div class="messages">
      <div *ngFor="let msg of messages" [ngClass]="{'message-user': msg.role === 'user', 'message-assistant': msg.role === 'assistant'}">
        <div class="message-content">
          <ng-container *ngIf="msg.role === 'assistant'; else userContent">
            <markdown [data]="msg.content"></markdown>
          </ng-container>
          <ng-template #userContent>
            {{ msg.content }}
          </ng-template>
        </div>
      </div>
      <div *ngIf="isLoading" class="loading">Digitando</div>
    </div>

    <div class="input-area">
      <input [(ngModel)]="newMessage" (keyup.enter)="sendMessage()" placeholder="Digite sua dÃºvida..." />
      <button (click)="sendMessage()" [disabled]="isLoading || !newMessage.trim()">
        <i class="pi pi-send"></i>
      </button>
    </div>
  </div>
</div>
